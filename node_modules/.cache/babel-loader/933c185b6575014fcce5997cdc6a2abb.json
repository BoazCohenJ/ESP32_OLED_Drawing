{"ast":null,"code":"import React from 'react';\nconst getCoordinates = index => ({\n  x: index % 128,\n  y: Math.floor(index / 128)\n});\nconst getIndex = (x, y) => y * 128 + x;\nconst drawRectangle = (start, end) => {\n  const points = [];\n  const startX = Math.min(start.x, end.x);\n  const startY = Math.min(start.y, end.y);\n  const endX = Math.max(start.x, end.x);\n  const endY = Math.max(start.y, end.y);\n\n  // Draw the rectangle perimeter\n  for (let x = startX; x <= endX; x++) {\n    // Draw top and bottom lines\n    if (startX <= x && x <= endX) {\n      if (startY >= 0 && startY < 64) {\n        const topIndex = getIndex(x, startY);\n        if (topIndex >= 0 && topIndex < 8192) points.push(topIndex);\n      }\n      if (endY >= 0 && endY < 64) {\n        const bottomIndex = getIndex(x, endY);\n        if (bottomIndex >= 0 && bottomIndex < 8192) points.push(bottomIndex);\n      }\n    }\n  }\n\n  // Draw left and right lines (avoiding corners which are already drawn)\n  for (let y = startY + 1; y < endY; y++) {\n    // Draw left and right lines\n    if (startY < y && y < endY) {\n      if (startX >= 0 && startX < 128) {\n        const leftIndex = getIndex(startX, y);\n        if (leftIndex >= 0 && leftIndex < 8192) points.push(leftIndex);\n      }\n      if (endX >= 0 && endX < 128) {\n        const rightIndex = getIndex(endX, y);\n        if (rightIndex >= 0 && rightIndex < 8192) points.push(rightIndex);\n      }\n    }\n  }\n  return points;\n};\nconst RectangleMode = ({\n  isActive,\n  onPixelUpdate,\n  onPreviewUpdate,\n  drawColor = true\n}) => {\n  const updateRectangle = (startPoint, endPoint) => {\n    if (!startPoint || !endPoint) return;\n    const rectanglePoints = drawRectangle(startPoint, endPoint);\n    const newPreview = Array(8192).fill(false);\n    rectanglePoints.forEach(idx => {\n      newPreview[idx] = drawColor ? true : 'black-preview';\n    });\n    return newPreview;\n  };\n  const handlePreview = (startPoint, currentIndex) => {\n    if (!startPoint || typeof currentIndex !== 'number') return;\n    const currentPoint = getCoordinates(currentIndex);\n    const previewState = updateRectangle(startPoint, currentPoint);\n    onPreviewUpdate(() => previewState);\n  };\n  const handleCommit = (startPoint, endIndex) => {\n    if (!startPoint || typeof endIndex !== 'number') return;\n    const endPoint = getCoordinates(endIndex);\n    const rectanglePoints = drawRectangle(startPoint, endPoint);\n    return rectanglePoints;\n  };\n  return {\n    handlePreview,\n    handleCommit,\n    modeName: 'Rectangle Mode',\n    isActive\n  };\n};\n_c = RectangleMode;\nexport default RectangleMode;\nvar _c;\n$RefreshReg$(_c, \"RectangleMode\");","map":{"version":3,"names":["React","getCoordinates","index","x","y","Math","floor","getIndex","drawRectangle","start","end","points","startX","min","startY","endX","max","endY","topIndex","push","bottomIndex","leftIndex","rightIndex","RectangleMode","isActive","onPixelUpdate","onPreviewUpdate","drawColor","updateRectangle","startPoint","endPoint","rectanglePoints","newPreview","Array","fill","forEach","idx","handlePreview","currentIndex","currentPoint","previewState","handleCommit","endIndex","modeName","_c","$RefreshReg$"],"sources":["C:/Users/wikx3/Documents/VS_code/React/ESP32_OLED_Drawing/src/components/pixelGrid/RectangleMode.jsx"],"sourcesContent":["import React from 'react';\r\n\r\nconst getCoordinates = (index) => ({\r\n  x: index % 128,\r\n  y: Math.floor(index / 128)\r\n});\r\n\r\nconst getIndex = (x, y) => y * 128 + x;\r\n\r\nconst drawRectangle = (start, end) => {\r\n  const points = [];\r\n  const startX = Math.min(start.x, end.x);\r\n  const startY = Math.min(start.y, end.y);\r\n  const endX = Math.max(start.x, end.x);\r\n  const endY = Math.max(start.y, end.y);\r\n  \r\n  // Draw the rectangle perimeter\r\n  for (let x = startX; x <= endX; x++) {\r\n    // Draw top and bottom lines\r\n    if (startX <= x && x <= endX) {\r\n      if (startY >= 0 && startY < 64) {\r\n        const topIndex = getIndex(x, startY);\r\n        if (topIndex >= 0 && topIndex < 8192) points.push(topIndex);\r\n      }\r\n      \r\n      if (endY >= 0 && endY < 64) {\r\n        const bottomIndex = getIndex(x, endY);\r\n        if (bottomIndex >= 0 && bottomIndex < 8192) points.push(bottomIndex);\r\n      }\r\n    }\r\n  }\r\n  \r\n  // Draw left and right lines (avoiding corners which are already drawn)\r\n  for (let y = startY + 1; y < endY; y++) {\r\n    // Draw left and right lines\r\n    if (startY < y && y < endY) {\r\n      if (startX >= 0 && startX < 128) {\r\n        const leftIndex = getIndex(startX, y);\r\n        if (leftIndex >= 0 && leftIndex < 8192) points.push(leftIndex);\r\n      }\r\n      \r\n      if (endX >= 0 && endX < 128) {\r\n        const rightIndex = getIndex(endX, y);\r\n        if (rightIndex >= 0 && rightIndex < 8192) points.push(rightIndex);\r\n      }\r\n    }\r\n  }\r\n  \r\n  return points;\r\n};\r\n\r\nconst RectangleMode = ({ isActive, onPixelUpdate, onPreviewUpdate, drawColor = true }) => {\r\n  const updateRectangle = (startPoint, endPoint) => {\r\n    if (!startPoint || !endPoint) return;\r\n    \r\n    const rectanglePoints = drawRectangle(startPoint, endPoint);\r\n    const newPreview = Array(8192).fill(false);\r\n    rectanglePoints.forEach(idx => {\r\n      newPreview[idx] = drawColor ? true : 'black-preview';\r\n    });\r\n    \r\n    return newPreview;\r\n  };\r\n\r\n  const handlePreview = (startPoint, currentIndex) => {\r\n    if (!startPoint || typeof currentIndex !== 'number') return;\r\n    const currentPoint = getCoordinates(currentIndex);\r\n    const previewState = updateRectangle(startPoint, currentPoint);\r\n    onPreviewUpdate(() => previewState);\r\n  };\r\n\r\n  const handleCommit = (startPoint, endIndex) => {\r\n    if (!startPoint || typeof endIndex !== 'number') return;\r\n    const endPoint = getCoordinates(endIndex);\r\n    const rectanglePoints = drawRectangle(startPoint, endPoint);\r\n    return rectanglePoints;\r\n  };\r\n\r\n  return {\r\n    handlePreview,\r\n    handleCommit,\r\n    modeName: 'Rectangle Mode',\r\n    isActive\r\n  };\r\n};\r\n\r\nexport default RectangleMode;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}