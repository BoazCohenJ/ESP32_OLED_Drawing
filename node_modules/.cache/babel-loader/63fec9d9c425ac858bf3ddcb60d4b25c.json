{"ast":null,"code":"import React from 'react';\nconst getCoordinates = index => ({\n  x: index % 128,\n  y: Math.floor(index / 128)\n});\nconst getIndex = (x, y) => y * 128 + x;\nconst drawLine = (start, end) => {\n  const points = [];\n  let x1 = start.x;\n  let y1 = start.y;\n  let x2 = end.x;\n  let y2 = end.y;\n  const dx = Math.abs(x2 - x1);\n  const dy = Math.abs(y2 - y1);\n  const sx = x1 < x2 ? 1 : -1;\n  const sy = y1 < y2 ? 1 : -1;\n  let err = dx - dy;\n  while (true) {\n    const index = getIndex(x1, y1);\n    if (index >= 0 && index < 8192) {\n      points.push(index);\n    }\n    if (x1 === x2 && y1 === y2) break;\n    const e2 = 2 * err;\n    if (e2 > -dy) {\n      err -= dy;\n      x1 += sx;\n    }\n    if (e2 < dx) {\n      err += dx;\n      y1 += sy;\n    }\n  }\n  return points;\n};\nconst LineMode = ({\n  isActive,\n  onPixelUpdate,\n  onPreviewUpdate\n}) => {\n  const updateLine = (startPoint, endPoint) => {\n    if (!startPoint || !endPoint) return;\n    const linePoints = drawLine(startPoint, endPoint);\n    const newPreview = Array(8192).fill(false);\n    linePoints.forEach(idx => {\n      newPreview[idx] = true;\n    });\n    return newPreview;\n  };\n  const handlePreview = (startPoint, currentIndex) => {\n    if (!startPoint || typeof currentIndex !== 'number') return;\n    const currentPoint = getCoordinates(currentIndex);\n    const previewState = updateLine(startPoint, currentPoint);\n    onPreviewUpdate(() => previewState);\n  };\n  const handleCommit = (startPoint, endIndex) => {\n    if (!startPoint || typeof endIndex !== 'number') return;\n    const endPoint = getCoordinates(endIndex);\n    const linePoints = drawLine(startPoint, endPoint);\n    onPixelUpdate(prev => {\n      const newPixels = [...prev];\n      linePoints.forEach(idx => {\n        newPixels[idx] = true;\n      });\n      return newPixels;\n    });\n  };\n  return {\n    handlePreview,\n    handleCommit,\n    modeName: 'Line Mode',\n    isActive\n  };\n};\n_c = LineMode;\nexport default LineMode;\nvar _c;\n$RefreshReg$(_c, \"LineMode\");","map":{"version":3,"names":["React","getCoordinates","index","x","y","Math","floor","getIndex","drawLine","start","end","points","x1","y1","x2","y2","dx","abs","dy","sx","sy","err","push","e2","LineMode","isActive","onPixelUpdate","onPreviewUpdate","updateLine","startPoint","endPoint","linePoints","newPreview","Array","fill","forEach","idx","handlePreview","currentIndex","currentPoint","previewState","handleCommit","endIndex","prev","newPixels","modeName","_c","$RefreshReg$"],"sources":["C:/Users/wikx3/Documents/VS_code/React/AOD/src/components/pixelGrid/LineMode.jsx"],"sourcesContent":["import React from 'react';\r\n\r\nconst getCoordinates = (index) => ({\r\n  x: index % 128,\r\n  y: Math.floor(index / 128)\r\n});\r\n\r\nconst getIndex = (x, y) => y * 128 + x;\r\n\r\nconst drawLine = (start, end) => {\r\n  const points = [];\r\n  let x1 = start.x;\r\n  let y1 = start.y;\r\n  let x2 = end.x;\r\n  let y2 = end.y;\r\n\r\n  const dx = Math.abs(x2 - x1);\r\n  const dy = Math.abs(y2 - y1);\r\n  const sx = x1 < x2 ? 1 : -1;\r\n  const sy = y1 < y2 ? 1 : -1;\r\n  let err = dx - dy;\r\n\r\n  while (true) {\r\n    const index = getIndex(x1, y1);\r\n    if (index >= 0 && index < 8192) {\r\n      points.push(index);\r\n    }\r\n\r\n    if (x1 === x2 && y1 === y2) break;\r\n    const e2 = 2 * err;\r\n    if (e2 > -dy) {\r\n      err -= dy;\r\n      x1 += sx;\r\n    }\r\n    if (e2 < dx) {\r\n      err += dx;\r\n      y1 += sy;\r\n    }\r\n  }\r\n\r\n  return points;\r\n};\r\n\r\nconst LineMode = ({ isActive, onPixelUpdate, onPreviewUpdate }) => {\r\n  const updateLine = (startPoint, endPoint) => {\r\n    if (!startPoint || !endPoint) return;\r\n    \r\n    const linePoints = drawLine(startPoint, endPoint);\r\n    const newPreview = Array(8192).fill(false);\r\n    linePoints.forEach(idx => {\r\n      newPreview[idx] = true;\r\n    });\r\n    \r\n    return newPreview;\r\n  };\r\n\r\n  const handlePreview = (startPoint, currentIndex) => {\r\n    if (!startPoint || typeof currentIndex !== 'number') return;\r\n    \r\n    const currentPoint = getCoordinates(currentIndex);\r\n    const previewState = updateLine(startPoint, currentPoint);\r\n    onPreviewUpdate(() => previewState);\r\n  };\r\n\r\n  const handleCommit = (startPoint, endIndex) => {\r\n    if (!startPoint || typeof endIndex !== 'number') return;\r\n    \r\n    const endPoint = getCoordinates(endIndex);\r\n    const linePoints = drawLine(startPoint, endPoint);\r\n    \r\n    onPixelUpdate(prev => {\r\n      const newPixels = [...prev];\r\n      linePoints.forEach(idx => {\r\n        newPixels[idx] = true;\r\n      });\r\n      return newPixels;\r\n    });\r\n  };\r\n\r\n  return {\r\n    handlePreview,\r\n    handleCommit,\r\n    modeName: 'Line Mode',\r\n    isActive\r\n  };\r\n};\r\n\r\nexport default LineMode;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}