{"ast":null,"code":"import React from 'react';\nconst getCoordinates = index => ({\n  x: index % 128,\n  y: Math.floor(index / 128)\n});\nconst getIndex = (x, y) => y * 128 + x;\nconst drawLine = (start, end) => {\n  const points = [];\n  let x0 = start.x;\n  let y0 = start.y;\n  let x1 = end.x;\n  let y1 = end.y;\n\n  // Make sure coordinates are within bounds\n  x0 = Math.max(0, Math.min(127, x0));\n  y0 = Math.max(0, Math.min(63, y0));\n  x1 = Math.max(0, Math.min(127, x1));\n  y1 = Math.max(0, Math.min(63, y1));\n\n  // Determine if line is steep (|dy| > |dx|)\n  const steep = Math.abs(y1 - y0) > Math.abs(x1 - x0);\n\n  // If line is steep, transpose x and y\n  if (steep) {\n    [x0, y0] = [y0, x0];\n    [x1, y1] = [y1, x1];\n  }\n\n  // If x0 > x1, swap points to draw left to right\n  if (x0 > x1) {\n    [x0, x1] = [x1, x0];\n    [y0, y1] = [y1, y0];\n  }\n  const dx = x1 - x0;\n  const dy = Math.abs(y1 - y0);\n  const yStep = y0 < y1 ? 1 : -1;\n  let error = dx / 2;\n  let y = y0;\n  for (let x = x0; x <= x1; x++) {\n    const currentX = steep ? y : x;\n    const currentY = steep ? x : y;\n    const index = getIndex(currentX, currentY);\n    if (index >= 0 && index < 8192) {\n      points.push(index);\n    }\n    error -= dy;\n    if (error < 0) {\n      y += yStep;\n      error += dx;\n    }\n  }\n  return points;\n};\nconst LineMode = ({\n  isActive,\n  onPixelUpdate,\n  onPreviewUpdate\n}) => {\n  const updateLine = (startPoint, endPoint) => {\n    if (!startPoint || !endPoint) return;\n    const linePoints = drawLine(startPoint, endPoint);\n    const newPreview = Array(8192).fill(false);\n    linePoints.forEach(idx => {\n      newPreview[idx] = true;\n    });\n    return newPreview;\n  };\n  const handlePreview = (startPoint, currentIndex) => {\n    if (!startPoint || typeof currentIndex !== 'number') return;\n    const currentPoint = getCoordinates(currentIndex);\n    const previewState = updateLine(startPoint, currentPoint);\n    onPreviewUpdate(() => previewState);\n  };\n  const handleCommit = (startPoint, endIndex) => {\n    if (!startPoint || typeof endIndex !== 'number') return;\n    const endPoint = getCoordinates(endIndex);\n    const linePoints = drawLine(startPoint, endPoint);\n\n    // Return the points instead of updating state directly\n    return linePoints;\n  };\n  return {\n    handlePreview,\n    handleCommit,\n    modeName: 'Line Mode',\n    isActive\n  };\n};\n_c = LineMode;\nexport default LineMode;\nvar _c;\n$RefreshReg$(_c, \"LineMode\");","map":{"version":3,"names":["React","getCoordinates","index","x","y","Math","floor","getIndex","drawLine","start","end","points","x0","y0","x1","y1","max","min","steep","abs","dx","dy","yStep","error","currentX","currentY","push","LineMode","isActive","onPixelUpdate","onPreviewUpdate","updateLine","startPoint","endPoint","linePoints","newPreview","Array","fill","forEach","idx","handlePreview","currentIndex","currentPoint","previewState","handleCommit","endIndex","modeName","_c","$RefreshReg$"],"sources":["C:/Users/wikx3/Documents/VS_code/React/AOD/src/components/pixelGrid/LineMode.jsx"],"sourcesContent":["import React from 'react';\r\n\r\nconst getCoordinates = (index) => ({\r\n  x: index % 128,\r\n  y: Math.floor(index / 128)\r\n});\r\n\r\nconst getIndex = (x, y) => y * 128 + x;\r\n\r\nconst drawLine = (start, end) => {\r\n  const points = [];\r\n  let x0 = start.x;\r\n  let y0 = start.y;\r\n  let x1 = end.x;\r\n  let y1 = end.y;\r\n\r\n  // Make sure coordinates are within bounds\r\n  x0 = Math.max(0, Math.min(127, x0));\r\n  y0 = Math.max(0, Math.min(63, y0));\r\n  x1 = Math.max(0, Math.min(127, x1));\r\n  y1 = Math.max(0, Math.min(63, y1));\r\n\r\n  // Determine if line is steep (|dy| > |dx|)\r\n  const steep = Math.abs(y1 - y0) > Math.abs(x1 - x0);\r\n\r\n  // If line is steep, transpose x and y\r\n  if (steep) {\r\n    [x0, y0] = [y0, x0];\r\n    [x1, y1] = [y1, x1];\r\n  }\r\n\r\n  // If x0 > x1, swap points to draw left to right\r\n  if (x0 > x1) {\r\n    [x0, x1] = [x1, x0];\r\n    [y0, y1] = [y1, y0];\r\n  }\r\n\r\n  const dx = x1 - x0;\r\n  const dy = Math.abs(y1 - y0);\r\n  const yStep = y0 < y1 ? 1 : -1;\r\n  \r\n  let error = dx / 2;\r\n  let y = y0;\r\n\r\n  for (let x = x0; x <= x1; x++) {\r\n    const currentX = steep ? y : x;\r\n    const currentY = steep ? x : y;\r\n    const index = getIndex(currentX, currentY);\r\n    \r\n    if (index >= 0 && index < 8192) {\r\n      points.push(index);\r\n    }\r\n\r\n    error -= dy;\r\n    if (error < 0) {\r\n      y += yStep;\r\n      error += dx;\r\n    }\r\n  }\r\n\r\n  return points;\r\n};\r\n\r\nconst LineMode = ({ isActive, onPixelUpdate, onPreviewUpdate }) => {\r\n  const updateLine = (startPoint, endPoint) => {\r\n    if (!startPoint || !endPoint) return;\r\n    \r\n    const linePoints = drawLine(startPoint, endPoint);\r\n    const newPreview = Array(8192).fill(false);\r\n    linePoints.forEach(idx => {\r\n      newPreview[idx] = true;\r\n    });\r\n    \r\n    return newPreview;\r\n  };\r\n\r\n  const handlePreview = (startPoint, currentIndex) => {\r\n    if (!startPoint || typeof currentIndex !== 'number') return;\r\n    \r\n    const currentPoint = getCoordinates(currentIndex);\r\n    const previewState = updateLine(startPoint, currentPoint);\r\n    onPreviewUpdate(() => previewState);\r\n  };\r\n\r\n  const handleCommit = (startPoint, endIndex) => {\r\n    if (!startPoint || typeof endIndex !== 'number') return;\r\n    \r\n    const endPoint = getCoordinates(endIndex);\r\n    const linePoints = drawLine(startPoint, endPoint);\r\n    \r\n    // Return the points instead of updating state directly\r\n    return linePoints;\r\n  };\r\n\r\n  return {\r\n    handlePreview,\r\n    handleCommit,\r\n    modeName: 'Line Mode',\r\n    isActive\r\n  };\r\n};\r\n\r\nexport default LineMode;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}